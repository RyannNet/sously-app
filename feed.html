<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sously - Feed</title>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300..900&family=Raleway:wght@400..900&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #FFCB28;
      --primary-dark: #FFA000;
      --secondary: #1E1E1E;
      --background: #FFFFFF;
      --surface: #F8F9FA;
      --border: #E1E1E1;
      --text-primary: #1E1E1E;
      --text-secondary: #666666;
      --text-tertiary: #999999;
      --danger: #FF4757;
      --success: #2ED573;
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.12);
      --radius: 12px;
      --radius-lg: 16px;
      --transition: all 0.2s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--background);
      color: var(--text-primary);
      font-family: "Rubik", sans-serif;
      line-height: 1.6;
      padding-bottom: 80px;
    }

    /* Header e outros estilos anteriores permanecem iguais */
    header {
      width: 100%;
      height: 70px;
      background: var(--background);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      padding: 0 24px;
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(10px);
    }

    .logo { height: 36px; object-fit: contain; }

    /* Sidebar, conteúdo principal e outros estilos permanecem */
    /* ... (mantenha todos os estilos anteriores) ... */

    /* Modal de Moderação */
    .mod-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }

    .mod-modal-content {
      background: var(--background);
      border-radius: var(--radius-lg);
      padding: 24px;
      width: 90%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: var(--shadow-md);
    }

    .mod-modal h3 {
      margin: 0 0 20px 0;
      color: var(--text-primary);
      text-align: center;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--primary);
    }

    .mod-input {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-bottom: 16px;
      font-family: "Rubik", sans-serif;
      font-size: 14px;
    }

    .mod-input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .mod-buttons {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 20px;
    }

    .mod-btn {
      padding: 10px 20px;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
    }

    .mod-btn.cancel {
      background: var(--surface);
      color: var(--text-secondary);
    }

    .mod-btn.confirm {
      background: var(--danger);
      color: white;
    }

    .mod-btn.primary {
      background: var(--primary);
      color: var(--secondary);
    }

    .user-selection {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      margin-bottom: 12px;
      cursor: pointer;
      transition: var(--transition);
    }

    .user-selection:hover {
      background: var(--surface);
    }

    .user-selection img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }

    .user-selection-info {
      flex: 1;
    }

    .user-selection-info strong {
      display: block;
      margin-bottom: 4px;
    }

    .user-selection-info span {
      font-size: 12px;
      color: var(--text-tertiary);
    }

    /* Indicador de seleção em posts */
    .post.selected {
      border: 2px solid var(--danger);
      background: rgba(255, 71, 87, 0.05);
    }

    .selection-indicator {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--danger);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
    }

    /* Menu de contexto para posts */
    .post-context-menu {
      position: absolute;
      background: var(--background);
      border-radius: var(--radius);
      box-shadow: var(--shadow-md);
      padding: 8px 0;
      z-index: 1000;
      display: none;
      min-width: 200px;
      border: 1px solid var(--border);
    }

    .context-menu-item {
      padding: 12px 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition);
    }

    .context-menu-item:hover {
      background: var(--surface);
    }

    .context-menu-item span {
      color: var(--primary);
    }

    /* Tela de castigo */
    .punishment-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      color: white;
      z-index: 3000;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
      padding: 20px;
    }

    .punishment-content {
      max-width: 500px;
    }

    .punishment-content h2 {
      margin-bottom: 20px;
      color: var(--primary);
    }

    .punishment-btn {
      background: var(--primary);
      color: var(--secondary);
      border: none;
      padding: 12px 24px;
      border-radius: var(--radius);
      font-weight: 600;
      cursor: pointer;
      margin-top: 20px;
      transition: var(--transition);
    }

    .punishment-btn:hover {
      background: var(--primary-dark);
    }
  </style>
</head>
<body>
  <!-- Estrutura HTML anterior permanece igual -->
  <!-- ... -->

  <!-- Modal de Moderação -->
  <div class="mod-modal" id="modModal">
    <div class="mod-modal-content">
      <h3 id="modModalTitle">Moderar Conteúdo</h3>
      <div id="modModalContent">
        <!-- Conteúdo dinâmico será inserido aqui -->
      </div>
      <div class="mod-buttons">
        <button class="mod-btn cancel" onclick="closeModModal()">Cancelar</button>
        <button class="mod-btn confirm" id="modConfirmBtn" onclick="confirmModAction()">Confirmar</button>
      </div>
    </div>
  </div>

  <!-- Tela de Castigo -->
  <div class="punishment-screen" id="punishmentScreen">
    <div class="punishment-content">
      <h2>Você Foi Escondido</h2>
      <p>Ninguém pode ver seus posts nem sua conta enquanto o moderador não retirar esta restrição.</p>
      <p>Quer saber quando o administrador poderá remover seu castigo?</p>
      <button class="punishment-btn" onclick="remindMe()">Sim, me lembrar</button>
      <a href="#" style="color: #FFCB28; margin-top: 15px; display: inline-block;">Ver regras da rede social</a>
    </div>
  </div>

  <script>
    // Variáveis globais
    let selectedPost = null;
    let selectedUser = null;
    let currentModAction = '';
    const modModal = document.getElementById('modModal');
    const modModalTitle = document.getElementById('modModalTitle');
    const modModalContent = document.getElementById('modModalContent');
    const modConfirmBtn = document.getElementById('modConfirmBtn');
    const punishmentScreen = document.getElementById('punishmentScreen');

    // Função para abrir modal de moderação
    function openModModal(action, post = null, user = null) {
      currentModAction = action;
      selectedPost = post;
      selectedUser = user;
      
      // Configurar o modal baseado na ação
      switch(action) {
        case 'warn':
          modModalTitle.textContent = 'Advertir Usuário';
          modModalContent.innerHTML = `
            <p>Digite a mensagem de advertência para <strong>${user.name}</strong>:</p>
            <textarea class="mod-input" placeholder="Motivo da advertência..." rows="4"></textarea>
            <p><small>A advertência será enviada por mensagem privada.</small></p>
          `;
          modConfirmBtn.textContent = 'Enviar Advertência';
          modConfirmBtn.className = 'mod-btn primary';
          break;
          
        case 'mute':
          modModalTitle.textContent = 'Mutar Usuário';
          modModalContent.innerHTML = `
            <p>Selecionar duração do mute para <strong>${user.name}</strong>:</p>
            <select class="mod-input">
              <option value="1">1 hora</option>
              <option value="6">6 horas</option>
              <option value="24" selected>24 horas</option>
              <option value="72">3 dias</option>
              <option value="168">7 dias</option>
            </select>
            <textarea class="mod-input" placeholder="Motivo do mute..." rows="3"></textarea>
          `;
          modConfirmBtn.textContent = 'Aplicar Mute';
          modConfirmBtn.className = 'mod-btn confirm';
          break;
          
        case 'ban':
          modModalTitle.textContent = 'Banir Usuário';
          modModalContent.innerHTML = `
            <p>Tem certeza que deseja banir permanentemente <strong>${user.name}</strong>?</p>
            <textarea class="mod-input" placeholder="Motivo do banimento..." rows="3" required></textarea>
            <p><small>Esta ação não pode ser desfeita.</small></p>
          `;
          modConfirmBtn.textContent = 'Banir Permanentemente';
          modConfirmBtn.className = 'mod-btn confirm';
          break;
          
        case 'banIp':
          modModalTitle.textContent = 'Banir por IP';
          modModalContent.innerHTML = `
            <p>Banir IP associado a <strong>${user.name}</strong>:</p>
            <input type="text" class="mod-input" value="192.168.1.1" readonly>
            <textarea class="mod-input" placeholder="Motivo do banimento por IP..." rows="3"></textarea>
            <p><small>Isso bloqueará todos os acessos deste IP.</small></p>
          `;
          modConfirmBtn.textContent = 'Banir IP';
          modConfirmBtn.className = 'mod-btn confirm';
          break;
          
        case 'deleteContent':
          modModalTitle.textContent = 'Excluir Conteúdo';
          modModalContent.innerHTML = `
            <p>Excluir post de <strong>${post.user.name}</strong>:</p>
            <div style="background: var(--surface); padding: 12px; border-radius: var(--radius); margin-bottom: 16px;">
              <p>${post.text || '(Conteúdo de mídia)'}</p>
            </div>
            <textarea class="mod-input" placeholder="Motivo da exclusão..." rows="3"></textarea>
          `;
          modConfirmBtn.textContent = 'Excluir Conteúdo';
          modConfirmBtn.className = 'mod-btn confirm';
          break;
          
        case 'blackout':
          modModalTitle.textContent = 'Esconder Usuário';
          modModalContent.innerHTML = `
            <p>Esconder <strong>${user.name}</strong> da plataforma:</p>
            <select class="mod-input">
              <option value="1">1 dia</option>
              <option value="3">3 dias</option>
              <option value="7">7 dias</option>
              <option value="30">30 dias</option>
              <option value="permanent">Permanentemente</option>
            </select>
            <textarea class="mod-input" placeholder="Motivo..." rows="3"></textarea>
          `;
          modConfirmBtn.textContent = 'Esconder Usuário';
          modConfirmBtn.className = 'mod-btn confirm';
          break;
          
        case 'limit':
          modModalTitle.textContent = 'Limitar Atividades';
          modModalContent.innerHTML = `
            <p>Limitar atividades de <strong>${user.name}</strong>:</p>
            <div style="margin-bottom: 16px;">
              <label><input type="checkbox" checked> Impedir de postar</label><br>
              <label><input type="checkbox" checked> Impedir de comentar</label><br>
              <label><input type="checkbox"> Impedir de curtir</label><br>
              <label><input type="checkbox"> Impedir de seguir usuários</label>
            </div>
            <select class="mod-input">
              <option value="1">1 dia</option>
              <option value="3">3 dias</option>
              <option value="7">7 dias</option>
              <option value="30">30 dias</option>
            </select>
            <textarea class="mod-input" placeholder="Motivo..." rows="3"></textarea>
          `;
          modConfirmBtn.textContent = 'Aplicar Limitações';
          modConfirmBtn.className = 'mod-btn confirm';
          break;
      }
      
      modModal.style.display = 'flex';
    }

    // Fechar modal
    function closeModModal() {
      modModal.style.display = 'none';
      selectedPost = null;
      selectedUser = null;
    }

    // Confirmar ação de moderação
    function confirmModAction() {
      // Aqui você implementaria a lógica real de moderação
      alert(`Ação de moderação "${currentModAction}" aplicada com sucesso!`);
      
      if (currentModAction === 'blackout') {
        punishmentScreen.style.display = 'flex';
      }
      
      closeModModal();
    }

    // Modificar a função de ação de moderação
    function modAction(action) {
      modPanel.style.display = "none";
      
      // Primeiro, precisamos selecionar um usuário ou conteúdo
      if (action === 'deleteContent') {
        // Para exclusão de conteúdo, mostramos posts para seleção
        showContentSelection();
      } else {
        // Para outras ações, mostramos usuários para seleção
        showUserSelection(action);
      }
    }

    // Mostrar seleção de usuários
    function showUserSelection(action) {
      const contas = JSON.parse(localStorage.getItem("contas")) || [];
      
      modModalTitle.textContent = 'Selecionar Usuário';
      modModalContent.innerHTML = `
        <p>Selecione o usuário para ${getActionName(action)}:</p>
        <div style="max-height: 300px; overflow-y: auto;">
          ${contas.map(user => `
            <div class="user-selection" onclick="selectUser('${user.email}', '${user.name}', '${action}')">
              <img src="${user.avatar}" alt="${user.name}">
              <div class="user-selection-info">
                <strong>${user.name}</strong>
                <span>${user.email}</span>
              </div>
            </div>
          `).join('')}
        </div>
      `;
      
      modConfirmBtn.style.display = 'none';
      modModal.style.display = 'flex';
    }

    // Mostrar seleção de conteúdo
    function showContentSelection() {
      const posts = JSON.parse(localStorage.getItem("posts")) || [];
      
      modModalTitle.textContent = 'Selecionar Conteúdo';
      modModalContent.innerHTML = `
        <p>Selecione o conteúdo para excluir:</p>
        <div style="max-height: 300px; overflow-y: auto;">
          ${posts.map((post, index) => `
            <div class="user-selection" onclick="selectPost(${index}, '${post.user.email}', 'deleteContent')">
              <img src="${post.user.avatar}" alt="${post.user.name}">
              <div class="user-selection-info">
                <strong>${post.user.name}</strong>
                <span>${post.text ? post.text.substring(0, 50) + '...' : 'Conteúdo de mídia'}</span>
              </div>
            </div>
          `).join('')}
        </div>
      `;
      
      modConfirmBtn.style.display = 'none';
      modModal.style.display = 'flex';
    }

    // Selecionar usuário
    function selectUser(email, name, action) {
      const user = { email, name };
      openModModal(action, null, user);
    }

    // Selecionar post
    function selectPost(index, userEmail, action) {
      const posts = JSON.parse(localStorage.getItem("posts")) || [];
      const post = posts[index];
      const user = { email: userEmail, name: post.user.name };
      openModModal(action, post, user);
    }

    // Obter nome da ação
    function getActionName(action) {
      const actions = {
        'warn': 'advertir',
        'mute': 'mutar', 
        'ban': 'banir',
        'banIp': 'banir por IP',
        'blackout': 'esconder',
        'limit': 'limitar atividades'
      };
      return actions[action] || action;
    }

    // Adicionar menu de contexto aos posts
    function addContextMenuToPosts() {
      const posts = document.querySelectorAll('.post');
      posts.forEach(post => {
        post.addEventListener('contextmenu', function(e) {
          e.preventDefault();
          // Implementar menu de contexto para moderação rápida
          // (opcional para o futuro)
        });
      });
    }

    // Lembrar sobre castigo
    function remindMe() {
      alert('Lembrete ativado! Você receberá uma notificação quando o administrador revisar seu caso.');
      punishmentScreen.style.display = 'none';
    }

    // Fechar tela de castigo com ESC
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        punishmentScreen.style.display = 'none';
        modModal.style.display = 'none';
      }
    });

    // Inicializar quando o DOM estiver carregado
    document.addEventListener('DOMContentLoaded', function() {
      // Seu código de inicialização existente
      // ...
      
      // Adicionar event listener para fechar modal clicando fora
      modModal.addEventListener('click', function(e) {
        if (e.target === modModal) {
          closeModModal();
        }
      });
    });
  </script>
</body>
</html>
